# Objective 1 - Handle Authentication With Tokens in a React App

## Overview

In general, servers don't remember anything about us after each interaction. Clients need to tack a reminder to every request, and this is commonly done automatically with cookies. Cookies are just small pieces of data generated by the browser to store state information.

Modern web services dealing with JSON data often use Jason Web Tokens (JWT)instead. These tokens, issued by the server, are strings of cryptic text that can be stored on the client-side using local or session storage. The server can readily tell the client that it issued the token. It can also read the token and make decisions for data transfer based on the client's permission.

A common pattern is for a login endpoint to exist, which takes a payload of ```username``` and ```password```. If the credentials are known, the server responds with a fresh JWT. From then on, it's the application's responsibility to add an ```Authorization: <token>``` header to every request, to be allowed access to protected resources that require authentication.

##  Follow Along

We are going to create an Axios configuration that attaches an ```Authorization: <token>``` header to requests. To do that, we will create a new file called ```axiosAuth.js```. Whenever the application needs to exchange data with a protected endpoint, it imports this module, instead of the usual ```import axios from "axios";```.

```
import axios from 'axios';

export const axiosWithAuth =() => {
    const token = localStorage.getItem('token');

    return axios.create({
        headers: {
            Authorization: token,
        },
    });
};

```
**Note:** Some APIs require you to use a slightly different syntax. Make sure you understand the API you are working with:

```
Authorization: `Bearer ${token}`,
```
After the user properly authenticates (properly logs in), the server returns the token. Your application needs to save the returned token (the permissions) to ```localStorage```, so that the above ```axiosWithAuth``` module can grab it for other calls that require the Authorization header.

```
const login = () => {
  axios.post('endpoint/here', userCredentials)
    .then(res => {
      localStorage.setItem('token', res.data.token);
      props.history.push('/dashboard');
    }
}
```
Now that we have the token, we can do an AJAX request to an endpoint using the ```axiosWithAuth.js``` module.

```
import { axiosWithAuth } from '../../path/to/axiosAuth.js';
  // etc
  axiosWithAuth().get('endpoint/path/here').then(data => /* do something with the data */);
```

If you inspect the request on the Network tab in Chrome Devtools, you should see ```Authorization: eyJ1c2VySWQiOiJiMDhmODZhZi0zNWRhLTQ4ZjItOGZhYi1jZWYzOTA0NjYwYmQifQ``` among the request headers.



## Challenge

Improve our custom Axios configuration using the library ```axios-retry```. The idea is to automatically retry the request three times if there are errors or timeouts.



[Previous](../README.md) | [Next](./Object_2.md)
